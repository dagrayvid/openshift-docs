// Module included in the following assemblies:
//
// * hardware_enablement/psap-special-resource-operator.adoc

[id="installing-the-special-resource-operator_{context}"]
= Installing the Special Resource Operator

As a cluster administrator, you can install the Special Resource Operator (SRO) using the {product-title} CLI or the web console.

[id="install-operator-cli_{context}"]
== Installing the Special Resource Operator using the CLI

As a cluster administrator, you can install SRO using the CLI.

.Prerequisites

* You have a running {product-title} cluster.
* You have installed the OpenShift CLI (`oc`).
* You are logged into the OpenShift CLI as a user with `cluster-admin` privileges.
* You have installed the Node Feature Discovery (NFD) Operator.

.Procedure

. Create a namespace for the Special Resource Operator.

.. Create the `Namespace` custom resource (CR) that defines the `openshift-special-resource-operator` namespace, and then save the YAML in the `sro-namespace.yaml` file:
+
[source,yaml]
----
apiVersion: v1
kind: Namespace
metadata:
  name: openshift-special-resource-operator
----

.. Create the namespace by running the following command:
+
[source,terminal]
----
$ oc create -f sro-namespace.yaml
----

. Install SRO in the namespace you created in the previous step.

.. Create the `OperatorGroup` CR and save the YAML in the `sro-operatorgroup.yaml` file:
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  generateName: openshift-special-resource-operator-
  name: openshift-special-resource-operator
  namespace: openshift-special-resource-operator
spec:
  targetNamespaces:
  - openshift-special-resource-operator
----

.. Run the following `oc create` command to create the `OperatorGroup` CR:
+
[source,terminal]
----
$ oc create -f sro-operatorgroup.yaml
----

.. Run the following command to get the `channel` value required for the next step.
+
[source,terminal]
----
$ oc get packagemanifest special-resource-operator -n openshift-marketplace -o jsonpath='{.status.defaultChannel}'
----
+
.Example output
[source,terminal]
----
4.9
----

.. Create the `Subscription` CR and save the YAML in the `sro-sub.yaml` file. If the output from the previous command is different than the `spec.channel` field, replace it with the output from the previous command:
+
.Example Subscription
[source,yaml]
----
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: special-resource-operator
  namespace: openshift-special-resource-operator
spec:
  channel: "4.9"
  installPlanApproval: Automatic
  name: special-resource-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace
----

.. Create the subscription object by running the following command:
+
[source,terminal]
----
$ oc create -f sro-sub.yaml
----

.. Change to the `openshift-special-resource-operator` project:
+
[source,terminal]
----
$ oc project openshift-special-resource-operator
----

.Verification

* To verify that the Operator deployment is successful, run:
+
[source,terminal]
----
$ oc get pods
----
+
.Example output
[source,terminal]
----
NAME                                                   READY   STATUS    RESTARTS   AGE
special-resource-controller-manager-7bfb544d45-xx62r   2/2     Running   0          2m28s
----
+
A successful deployment shows a `Running` status.

[id="install-operator-web-console_{context}"]
== Installing the Special Resource Operator using the web console

As a cluster administrator, you can install the Special Resource Operator using the web console.

[NOTE]
====
It is recommended that you create the `Namespace` as detailed in the previous section.
====

.Procedure

. In the {product-title} web console, click *Operators* -> *OperatorHub*.

. Choose *Special Resource Operator* from the list of available Operators, and then click *Install*.

. On the *Install Operator* page, select *a specific namespace on the cluster*, select the namespace created in the previous section, and then click *Install*.

.Verification

To verify that the Special Resource Operator installed successfully:

. Navigate to the *Operators* -> *Installed Operators* page.
. Ensure that *Special Resource Operator* is listed in the *openshift-special-resource-operator* project with a *Status* of *InstallSucceeded*.
+
[NOTE]
====
During installation, an Operator might display a *Failed* status. If the installation later succeeds with an *InstallSucceeded* message, you can ignore the *Failed* message.
====

.Troubleshooting

If the Operator does not appear as installed, to troubleshoot further:

. Navigate to the *Operators* -> *Installed Operators* page and inspect the *Operator Subscriptions* and *Install Plans* tabs for any failure or errors under *Status*.
. Navigate to the *Workloads* -> *Pods* page and check the logs for pods in the `openshift-special-resource-operator` project.

[NOTE]
====
The Node Feature Discovery (NFD) Operator is a dependency of the Special Resource Operator (SRO). If the NFD Operator is not installed before installing SRO, the Operator Lifecycle Manager will automatically install the NFD Operator. However, the required Node Feature Discovery operand will not be deployed automatically. The Node Feature Discovery Operator documentation provides details about how to deploy NFD using the NFD Operator.
====